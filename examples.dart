import "dart:html" as BB;import "dart:math" as EB;import "dart:async" as CB;class MD{static const  ND="Chrome";static const  OD="Firefox";static const  PD="Internet Explorer";static const  QD="Safari";final  vC;final  minimumVersion;const MD(this.vC,[this.minimumVersion]);}class RD{final  name;const RD(this.name);}var JB=['red','blue','yellow','green','black','white']; FC( UB){var h=u(500,300);h..v(UB)..textBaseline="top"..lineWidth=5..strokeStyle='black'..fillStyle='black'..font='16px Verdana';var o=BB.query('#uitext');var l;l=o.value;o.onKeyUp.listen((eB){l=o.value;});var q='START GAME';var OB='INSTRUCTIONS';var g=6;var s=400;var k=300;var j=40;var VB=new BB.Rect(100,20,k,j);var WB=new BB.Rect(100,70,k,j);var DB=h.dB(q);var AB=h.dB(OB);var n=false;var i=null;KB('border.png').then((p){h.aB.AC.listen((m){var FB=h.dB(l,s);h..clear()..ED(5,5,490,290,20,strokeStyle:"#080D73",fillStyle:'#A69500')..borderImage(p,100,20,k,j,g,g,g,g,fillStyle:i==20?'#FFE500':'#FFF173')..borderImage(p,100,70,k,j,g,g,g,g,fillStyle:i==70?'#FFE500':'#FFF173')..borderImage(p,50,120,2*g+FB.width,2*g+FB.height,g,g,g,g,fillStyle:'#BFB030')..zB(q,100+(k-DB.width)~/2,20+(j-DB.height)~/2,[0,'blue',1,'red'])..zB(OB,100+(k-AB.width)~/2,70+(j-AB.height)~/2,[0,'red',0.5,'green',1,'blue'])..ID(l,50+g,120+g,s);if(n){h..BC(40,i,40,40,0.7*EB.sin(m.NB/200),0.5*EB.sin(m.NB/200).abs(),fillStyle:'#FFAA40')..BC(420,i,40,40,0.7*EB.sin(m.NB/200),0.5*EB.sin(m.NB/200).abs(),fillStyle:'#FFAA40');}});h.aB.onMouseMove.listen((w){if(VB.containsPoint(w)){n=true;i=20;}else if(WB.containsPoint(w)){n=true;i=70;}else{n=false;i=null;}});});} EC( l){KB('ships.png').then((k){var i=u(k)..canvas.classes.add('example');i.v(l);var g=BB.query("#hue");var j=BB.query("#saturation");var h=BB.query("#lightness");g.onChange.listen((VD)=>YB(k,g,j,h,i));j.onChange.listen((VD)=>YB(k,g,j,h,i));h.onChange.listen((VD)=>YB(k,g,j,h,i));});} DC( h){var g,j;var m=0;hB(['below.png','above.png']).then((k){g=k[0];j=k[1];var i=BB.query("#mix");gB(i,g,j,h);i.onChange.listen((VD){h.queryAll("canvas").forEach((l)=>l.remove());gB(i,g,j,h);});});} HC( g){KB('farminglpc.png').then((h){u(h)..canvas.classes.add('example')..canvas.title='This is the source image'..v(g);g.appendHtml('<br />');u(h)..canvas.classes.add('example')..blur()..canvas.title='.blur()'..v(g);u(h)..canvas.classes.add('example')..FD()..canvas.title='.sharpen()'..v(g);u(h)..canvas.classes.add('example')..IB([0,1,0,1,-4,1,0,1,0])..canvas.title='.convolve([0, 1, 0, 1, -4, 1, 0, 1, 0])'..v(g);u(h)..canvas.classes.add('example')..IB([1/2])..canvas.title='.convolve([1/2])'..v(g);u(h)..canvas.classes.add('example')..IB([2])..canvas.title='.convolve([2])'..v(g);u(h)..canvas.classes.add('example')..IB([1/2,2,1/9,2,1/9,-2,1/9,-2,-1/2])..canvas.title='.convolve([1/2, 2, 1/9, 2, 1/9, -2, 1/9, -2, -1/2])'..v(g);});} GC( h){var g,i;hB(['farminglpc.png','mask.png']).then((j){g=j[0];i=j[1];h..append(g)..appendText('+')..append(i)..appendHtml('<br />=<br />');var k=u(i);var l=k.AD();var m=k.wC('#000000');u(g)..uB(l)..canvas.title='''
List<int> grayscaleMask = cq(maskImg).grayscaleToMask();\n
cq(image).applyMask(grayscaleMask)'''..v(h);u(g)..uB(m)..canvas.title='''
List<int> colorMask = cq(maskImg).colorToMask('#000000');\n
cq(image).applyMask(colorMask)'''..v(h);});}var PB={'dawnbringer':{'name':'Dawnbringer','res':'dawnbringerpalette.png','url':'http://www.pixeljoint.com/forum/forum_posts.asp?TID=12795'},'nes':{'name':'NES','res':'nespalette.png','url':'http://en.wikipedia.org/wiki/File:NES_palette.png'},'pal':{'name':'PAL','res':'palpalette.png','url':'http://en.wikipedia.org/wiki/File:Atari2600_PAL_palette.png'},'sega':{'name':'SEGA','res':'mastersystempalette.png','url':'http://en.wikipedia.org/wiki/File:RGB_6bits_palette.png'}}; IC( DB){var m=500;var n=300;var p=false;var h=0;var j;var i=u(m,n);var k=u(m,n);k..canvas.style.backgroundColor='white'..v(DB);var g=k.aB;g.onMouseMove.listen((s)=>j=s);g.AC.listen((VD){if(null!=j){if(p){i..xB(j.x,j.y,15)..fillStyle=JB[h]..fill();}k..clear(color:'white')..globalAlpha=1..drawImage(i.canvas,0,0)..globalAlpha=0.2..xB(j.x,j.y,15)..fillStyle=JB[h]..fill();}});g.onMouseDown.listen((o){if(0==o.button){p=true;}});g.onMouseUp.listen((o){if(0==o.button){p=false;}});g.onKeyDown.listen((q){if(q==BB.KeyCode.LEFT){h=(h-1)%JB.length;}else if(q==BB.KeyCode.RIGHT){h=(h+1)%JB.length;}});g.CD.listen((l){i.canvas..width=l.width..height=l.height;k.canvas..width=l.width..height=l.height;i.drawImage(l,0,0);}).onError((AB)=>BB.window.alert(AB.error));g.DD().listen((w){if(w=='down'&&JB[h]=='white'){i.canvas..width=m..height=n;k.canvas..width=m..height=n;i.clear();}});}var fB={'coloring':EC,'blending':DC,'masking':GC,'convolve':HC,'palette':LC,'framework':IC,'uigeneration':FC}; gB( g, i, k, j){g.disabled=true;var l=double.parse(g.value);for(String h in iB.keys){KC(i,k,h,l,j);}for(String h in jB.keys){MC(i,k,h,l,j);}g.disabled=false;} main(){BB.window.setImmediate((){fB.forEach((h,g)=>JC(h,g));});}var XB={'dawnbringer':{'name':'Dawnbringer','res':'dawnbringermockup.png','url':'http://www.pixeljoint.com/forum/forum_posts.asp?TID=12795'},'farming':{'name':'Farming','res':'farminglpc.png','url':'http://opengameart.org/content/farming-tilesets-magic-animations-and-ui-elements'}}; JC( j, k){var h=BB.query("#show_${j}");h.onClick.listen((VD){fB.keys.forEach((i){BB.query("#${i}").style.display='none';BB.query("#show_${i}").classes.remove('highlight');});var g=BB.query("div#${j}");g.style.display='block';h.classes.add('highlight');if('true'!=g.dataset['init']){k(g);g.dataset['init']='true';}});} YB( k, l, j, m, n){var g=l.value;var o=j.value;var i=m.value;var h=u(k)..GD(hue:double.parse(g),saturation:double.parse(o),lightness:double.parse(i))..canvas.classes.add('example');n.replaceWith(h);} KC(i,k, g, h, j){var l=iB[g];u(i)..vB(k,l,h)..v(j)..canvas.title='.blend(above, Blend.${g}, ${h});'..canvas.classes.add('example');} LC( n){var g=BB.query('#paletteselect');var i=BB.query('#imageselect');g.append(new BB.OptionElement('None','',true,true));var l=new List<CB.Future<BB.ImageElement>>();l.addAll(kB(g,PB));l.addAll(kB(i,XB));CB.Future.wait(l).then((VD){var h=new BB.DivElement();var k=new BB.AnchorElement();h..classes.add('credits')..appendText('Palette: ')..append(k);var m=u(XB[i.value]['img']);m..v(n); q(VD){var j=g.value;var o=XB[i.value]['img'];var p=u(o);if(""==j){m.replaceWith(p);h.remove();}else{var s=u(PB[j]['img']).zC();h.style.width='${o.width}px';m.replaceWith(p..BD(s)..canvas.title='.matchPalette(palette)');k.href=PB[j]['url'];k.text='${PB[j]['name']}';n.append(h);}}g.onChange.listen(q);i.onChange.listen(q);});} MC(i,k, g, h, j){var l=jB[g];u(i)..wB(k,l,h)..v(j)..canvas.title='.blendSpecial(above, Blend.${g}, ${h});'..canvas.classes.add('example');} hB( i){var g=new List<CB.Future<BB.ImageElement>>();i.forEach((h)=>g.add(KB(h)));return CB.Future.wait(g);} KB( i){var g=new BB.ImageElement();var h=new CB.Completer<BB.ImageElement>();g.onLoad.listen((j)=>h.complete(g));g.src=i;return h.future;}var iB={'normal':t.NC,'overlay':t.lB,'hardLight':t.OC,'softLight':t.PC,'dodge':t.QC,'burn':t.RC,'multiply':t.SC,'divide':t.TC,'screen':t.UC,'grainExtract':t.VC,'grainMerge':t.WC,'difference':t.XC,'addition':t.YC,'substract':t.ZC,'darkenOnly':t.aC,'lightenOnly':t.bC};var jB={'color':t.cC,'hue':t.dC,'value':t.eC,'saturation':t.fC};kB( m, k){var h=new List<CB.Future<BB.ImageElement>>();k.forEach((l,g){var j=new CB.Completer();h.add(j.future);KB(g['res']).then((i){g['img']=i;m.append(new BB.OptionElement(g['name'],l,false,false));j.complete(i);});});return h;}typedef  QB( a, b);typedef  RB( a, b);class t{static  NC( h, g)=>g;static  lB( g, h){g/= 255;h/= 255;var i=0;if(g<0.5)i=2*g*h;else i=1-2*(1-g)*(1-h);return EB.min(255,EB.max(0,i*255)).toInt();}static  OC( g, h)=>t.lB(h,g);static  PC( g, h){g/= 255;h/= 255;var i=((1-2*h)*g+2*h)*g;return LB((i*255).toInt(),0,255);}static  QC( g, h)=>EB.min(256*g~/(255-h+1),255);static  RC( g, h)=>255-EB.min(256*(255-g)~/(h+1),255);static  SC( g, h)=>h*g~/255;static  TC( g, h)=>EB.min(256*g~/(h+1),255);static  UC( g, h)=>255-(255-h)*(255-g)~/255;static  VC( g, h)=>LB(g-h+128,0,255);static  WC( g, h)=>LB(g+h-128,0,255);static  XC( g, h)=>(g-h).abs();static  YC( g, h)=>EB.min(g+h,255);static  ZC( g, h)=>EB.max(g-h,0);static  aC( g, h)=>EB.min(g,h);static  bC( g, h)=>EB.max(g,h);static  cC( h, i){var j=rB(h);var g=rB(i);return tB(g[0],g[1],j[2]);}static  dC( i, j){var g=HB(i);var h=HB(j);if(h[1]==0)return SB(g[0],g[1],g[2]);else return SB(h[0],g[1],g[2]);}static  eC( h, i){var g=HB(h);var j=HB(i);return SB(g[0],g[1],j[2]);}static  fC( h, i){var g=HB(h);var j=HB(i);return SB(g[0],j[1],g[2]);}} LB( g, h, i)=>g<h?h:g>i?i:g; ZB( g, h, i)=>g+(h-g)*i; gC( g, h, i){if(g<h){g=i+(g-h);}else if(g>i){g=h+(g-i);}return g;}class GB{static final  hC=BB.window.navigator.userAgent.contains(r'Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone');static  iC( g,var l, m,[ mix=1]){nB(g,l,mix,(i,j,h,k){mC(i,j,h,k,m);});}static  jC( g,var l, m,[ mix=1]){nB(g,l,mix,(i,j,h,k){lC(i,j,h,k,m);});}static  nB( g,var h, j, o( pixels, belowPixels, abovePixels, mix)){var m=g.context2d;var l=u(h).canvas.context2d;var k=m.getImageData(0,0,g.width,g.height);var n=l.getImageData(0,0,h.width,h.height);var i=oB(g.width,g.height);o(i.data,k.data,n.data,j);g.context2d.putImageData(i,0,0);}static lC( i, h, j, k, m){for(int g=0;g<h.length;g+= 4){var l=m([h[g+0],h[g+1],h[g+2]],[j[g+0],j[g+1],j[g+2]]);i[g+0]=h[g+0]+((l[0]-h[g+0])*k).toInt();i[g+1]=h[g+1]+((l[1]-h[g+1])*k).toInt();i[g+2]=h[g+2]+((l[2]-h[g+2])*k).toInt();i[g+3]=h[g+3];}}static mC( i, h, j, k, l){for(int g=0;g<h.length;g+= 4){var m=l(h[g+0],j[g+0]);var n=l(h[g+1],j[g+1]);var o=l(h[g+2],j[g+2]);i[g+0]=h[g+0]+((m-h[g+0])*k).toInt();i[g+1]=h[g+1]+((n-h[g+1])*k).toInt();i[g+2]=h[g+2]+((o-h[g+2])*k).toInt();i[g+3]=h[g+3];}}static  nC( g){var h=new BB.CanvasElement(width:g.width,height:g.height);h.context2d.drawImage(g,0,0);return h;}static  oB( g, h){return new BB.CanvasElement().context2d.createImageData(g,h);}static  oC( g){var m=0,k=0,n=0,l=0,j=0,i=0;var h=g.currentTarget;do{m+= h.offset.left;k+= h.offset.top;}while(null!=(h=h.offsetParent));if(null!=g.page.x||null!=g.page.y){j=g.page.x;i=g.page.y;}else if(g is BB.MouseEvent){if(null!=g.client.x||null!=g.client.y){j=g.client.x+BB.document.body.scrollLeft+BB.document.documentElement.scrollLeft;i=g.client.y+BB.document.body.scrollTop+BB.document.documentElement.scrollTop;}}n=j-m;l=i-k;return new BB.Point(n,l);}}class mB{final  yB;mB.TD(this.yB); get WD=>yB.canvas; XD( g)=>GB.oC(g); get YD=>GB.hC; get AC{var h=new CB.StreamController<pC>();var g=BB.window.performance.now();i(TD){var j=BB.window.performance.now()-g;g=BB.window.performance.now();BB.window.animationFrame.then(i);h.add(new pC(j,g));}BB.window.animationFrame.then(i);return h.stream;} get onMouseMove{var g;if(YD){g=WD.onTouchMove;}else{g=WD.onMouseMove;}return g.map((h)=>XD(h));} get onMouseDown{var i=new CB.StreamController<pB>();var h;if(YD){h=WD.onTouchStart;}else{h=WD.onMouseDown;}h.listen((g){g.preventDefault();i.add(new pB(XD(g),g.button));});return i.stream;} get onMouseUp{var g;if(YD){g=WD.onTouchEnd;}else{g=WD.onMouseUp;}return g.map((h)=>new pB(XD(h),h.button));} DD({ threshold: 35, timeout: 350}){var o=new CB.StreamController<String>();var l=0;var m=0;var k=0;var p=0;n(g){g.preventDefault();l=XD(g);m=BB.window.performance.now();}q(g){g.preventDefault();k=XD(g);p=BB.window.performance.now();}s(g){g.preventDefault();var i=(l.x-k.x);var j=(l.y-k.y);var w=(i*i);var AB=(j*j);var DB=EB.sqrt(w+AB);var FB=(p-m);var h=null;if(DB>threshold&&FB<timeout){if(i.abs()>j.abs()){if(i>0){h="left";}else{h="right";}}else{if(j>0){h="up";}else{h="down";}}o.add(h);}}if(YD){WD.onTouchStart.listen((g)=>n(g));WD.onTouchMove.listen((g)=>q(g));WD.onTouchEnd.listen((g)=>s(g));}else{WD.onMouseDown.listen((g)=>n(g));WD.onMouseMove.listen((g)=>q(g));WD.onMouseUp.listen((g)=>s(g));}return o.stream;} get onKeyDown=>BB.document.onKeyDown.map((g)=>g.keyCode); get onKeyUp=>BB.document.onKeyUp.map((g)=>g.keyCode); get CD{var k=new CB.StreamController<BB.ImageElement>();BB.document.onDrop.listen(( g){g.stopPropagation();g.preventDefault();var i=g.dataTransfer.files[0];if(!i.type.startsWith('image/')){k.addError('unexpected filetype, "${i.name}" is not an image');return;}var h=new BB.FileReader();h.onLoad.listen(( m){var j=new BB.ImageElement();j.onLoad.listen((l){k.add(j);});j.src=h.result;});h.readAsDataUrl(i);});BB.document.onDragOver.listen((g){g.preventDefault();});return k.stream;}} u([var selector, height]){var g;if(null==selector||selector is int){var h=(selector!=null?selector:BB.window.innerWidth);height=(height!=null?height:BB.window.innerHeight);g=new BB.CanvasElement(width:h,height:height);}else if(selector is String){g=BB.query(selector);}else if(selector is BB.ImageElement){g=GB.nC(selector);}else if(selector is MB){return selector;}else{g=selector;}return new MB(g);}class MB implements BB.CanvasRenderingContext2D{static final  kC=new RegExp((r'\s+'));var WD;var ZD;var aD; get canvas=>WD; get context2d=>ZD; get aB=>aD;MB(this.WD){ZD=WD.context2d;aD=new mB.TD(this);} noSuchMethod( g)=>g.invokeOn(ZD); v( g){g.append(WD);} replaceWith( g){WD.replaceWith(g.canvas);WD=g.canvas;ZD=g.context2d;} vB(var g, h,[ mix=1]){if(g is String){blendColor(g,h,mix);}else{GB.iC(this.canvas,g,h,mix);}} blendColor( g, h,[ mix=1])=>vB(bD(g),h,mix); wB(var g, h,[ mix=1]){if(g is String){uC(g,h,mix);}else{GB.jC(this.canvas,g,h,mix);}} uC( g, h,[ mix=1])=>wB(bD(g),h,mix); bD( g)=>new BB.CanvasElement(width:WD.width,height:WD.height)..context2d.fillStyle=g..context2d.fillRect(0,0,WD.width,WD.height); cB({ strokeStyle, fillStyle}){if(null!=strokeStyle){var g=ZD.strokeStyle;ZD..strokeStyle=strokeStyle..stroke()..strokeStyle=g;}if(null!=fillStyle){var g=ZD.fillStyle;ZD..fillStyle=fillStyle..fill()..fillStyle=g;}} xB( i, g, h,{ strokeStyle, fillStyle}){ZD.beginPath();ZD.arc(i,g,h,0,EB.PI*2,true);ZD.closePath();cB(strokeStyle:strokeStyle,fillStyle:fillStyle);} xC( l, j, g, h){var i=new BB.CanvasElement(width:g,height:h);var k=i.context2d;k.drawImageScaledFromSource(WD,l,j,g,h,0,0,g,h);WD.width=g;WD.height=h;clear();ZD.drawImage(i,0,0);} trim({ color}){var l;var n;var m;if(color!=null){n=new rC.UD(color).HD();l=n[4]==255?true:false;}else l=true;var o=ZD.getImageData(0,0,WD.width,WD.height);var i=o.data;var g=[WD.width,WD.height,0,0];for(var h=0,p=i.length;h<p;h+= 4){if(l){if(i[h+3]==0)continue;}else if(i[h+0]==color[0]&&i[h+1]==color[1]&&i[h+2]==color[2])continue;var j=(h~/4)%WD.width;var k=(h~/4)~/WD.width;if(j<g[0])g[0]=j;if(j>g[2])g[2]=j;if(k<g[1])g[1]=k;if(k>g[3])g[3]=k;}if(g[2]==0||g[3]==0){}else{m=new BB.Rect(g[0],g[1],g[2]-g[0],g[3]-g[1]);xC(g[0],g[1],g[2]-g[0]+1,g[3]-g[1]+1);}return m;} BD( j){var i=ZD.getImageData(0,0,WD.width,WD.height);var k=new List<rC>(j.length);for(var g=0;g<j.length;g++ ){k[g]=new rC.UD(j[g]);}for(var g=0;g<i.data.length;g+= 4){var l=new List<int>(k.length);for(var h=0;h<k.length;h++ ){var m=k[h];var s=(i.data[g]-m.r).abs(),p=(i.data[g+1]-m.TB).abs(),q=(i.data[g+2]-m.b).abs();l[h]=s+p+q;}var n=0;for(var h=0;h<j.length;h++ ){if(l[h]<l[n]){n=h;}}var o=qB(j[n]);i.data[g]=o[0];i.data[g+1]=o[1];i.data[g+2]=o[2];}ZD.putImageData(i,0,0);} zC(){var i=new List<String>();var k=ZD.getImageData(0,0,WD.width,WD.height);var h=k.data;for(var g=0;g<h.length;g+= 4){if(0!=h[g+3]){var j=sC(h[g+0],h[g+1],h[g+2]);if(i.indexOf(j)==-1)i.add(j);}}return i;} wC( l,{ inverted: false}){var i=new rC.UD(l);var k=ZD.getImageData(0,0,WD.width,WD.height);var h=k.data;var j=new List<bool>(h.length~/4);for(var g=0;g<h.length;g+= 4){if(h[g+0]==i.r&&h[g+1]==i.TB&&h[g+2]==i.b)j[g~/4]=inverted;else j[g~/4]=!inverted;}return j;} AD(){var j=ZD.getImageData(0,0,WD.width,WD.height);var h=j.data;var i=new List<int>(h.length~/4);for(var g=0;g<h.length;g+= 4){i[g~/4]=(h[g+0]+h[g+1]+h[g+2])~/3;}return i;} uB( j){var i=ZD.getImageData(0,0,WD.width,WD.height);var h=i.data;var l=j is List<bool>?"bool":"byte";for(var g=0,m=h.length;g<m;g+= 4){var k=j[g~/4];if(l=="bool")h[g+3]=k?255:0;else h[g+3]=k;}ZD.putImageData(i,0,0);} clear({ color}){if(null!=color){ZD.fillStyle=color;ZD.fillRect(0,0,WD.width,WD.height);}else{ZD.clearRect(0,0,WD.width,WD.height);}} GD({ hue, saturation, lightness}){var n=null==hue?null:hue.toDouble();var q=null==saturation?null:saturation.toDouble();var k=null==lightness?null:lightness.toDouble();var l=ZD.getImageData(0,0,WD.width,WD.height);var h=l.data;var p,m,o;var i;var j;for(var g=0,s=h.length;g<s;g+= 4){i=sB(h[g+0],h[g+1],h[g+2]);p=n==null?i[0]:gC(i[0]+n,0.0,1.0);m=q==null?i[1]:LB(i[1]+q,0.0,1.0);o=k==null?i[2]:LB(i[2]+k,0.0,1.0);j=tB(p,m,o);h[g+0]=j[0];h[g+1]=j[1];h[g+2]=j[2];}ZD.putImageData(l,0,0);} ED( h, g, j, k, i,{ strokeStyle, fillStyle}){ZD..beginPath()..moveTo(h+i,g)..lineTo(h+j-i,g)..quadraticCurveTo(h+j,g,h+j,g+i)..lineTo(h+j,g+k-i)..quadraticCurveTo(h+j,g+k,h+j-i,g+k)..lineTo(h+i,g+k)..quadraticCurveTo(h,g+k,h,g+k-i)..lineTo(h,g+i)..quadraticCurveTo(h,g,h+i,g)..closePath();cB(strokeStyle:strokeStyle,fillStyle:fillStyle);} zB( q, n, p, j,[ maxWidth]){var s=new RegExp(r"(\d+)");var l=int.parse(s.firstMatch(font).group(0))*2;var k=bB(q,maxWidth);var o=ZD.fillStyle;for(var h=0;h<k.length;h++ ){var i=(p+h*l*0.6).toInt();var m=ZD.createLinearGradient(0,i,0,(i+l*0.6).toInt());for(var g=0;g<j.length;g+= 2){m.addColorStop(j[g],j[g+1]);}ZD..fillStyle=m..fillText(k[h],n,i);}ZD.fillStyle=o;} ID( o, h, l, m,{ nlCallback}){var p=new RegExp(r"(\d+)");var n=int.parse(p.firstMatch(font).group(0))*2;var i=bB(o,m);for(var g=0;g<i.length;g++ ){var j=(l+g*n*0.6).toInt();if(null!=nlCallback){nlCallback(h,j);}var k=i[g];ZD.fillText(k,h,j);}} dB( g,[ maxWidth]){var i=new RegExp(r"(\d+)");var h=int.parse(i.firstMatch(font).group(0))*2;var j=bB(g,maxWidth);if(null==maxWidth){maxWidth=ZD.measureText(g).width;}return new BB.Rect(0,0,maxWidth,(j.length*h*0.6).toInt());} bB( m,[ maxWidth]){var l=m.split(kC);var i=0;var p=0;var g=new List<String>.from([""]);var o=ZD.measureText(" ").width;if(null!=maxWidth){maxWidth+= o;var j=0;for(var h=0;h<l.length;h++ ){var n="${l[h]} ";var k=ZD.measureText(n).width;if(i+k>maxWidth){g.add("");j++ ;i=0;}g[j]="${g[j]}${n}";i+= k;}}else{g=[m];}return g;} BC( h, g, i, j, k, l,{ strokeStyle, fillStyle}){ZD..beginPath()..moveTo(h,g)..quadraticCurveTo(h+i/2,g+j*l,h+i,g)..quadraticCurveTo(h+i-i*k,g+j/2,h+i,g+j)..quadraticCurveTo(h+i/2,g+j-j*l,h,g+j)..quadraticCurveTo(h+i*k,g+j/2,h,g)..closePath();cB(strokeStyle:strokeStyle,fillStyle:fillStyle);} borderImage(var g, l, m, n, o, i, j, k, h,{ fill: false, fillStyle}){ZD..drawImageScaledFromSource(g,h,0,g.width-h-j,i,l+h,m,n-h-j,i)..drawImageScaledFromSource(g,h,g.height-k,g.width-h-j,k,l+h,m+o-k,n-h-j,k)..drawImageScaledFromSource(g,0,i,h,g.height-k-i,l,m+i,h,o-k-i)..drawImageScaledFromSource(g,g.width-j,i,j,g.height-k-i,l+n-j,m+i,j,o-k-i)..drawImageScaledFromSource(g,0,0,h,i,l,m,h,i)..drawImageScaledFromSource(g,g.width-j,0,j,i,l+n-j,m,j,i)..drawImageScaledFromSource(g,g.width-j,g.height-k,j,k,l+n-j,m+o-k,j,k)..drawImageScaledFromSource(g,0,g.height-k,h,k,l,m+o-k,h,k);if(null!=fillStyle){var p=ZD.fillStyle;ZD..fillStyle=fillStyle..fillRect(l+h,m+i,n-h-j,o-i-k)..fillStyle=p;}else if(fill){ZD.drawImageScaledFromSource(g,h,i,g.width-j-h,g.height-k-i,l+h,m+i,n-h-j,o-i-k);}} IB( w,{ mix: 1, divide: 1}){var DB=ZD.getImageData(0,0,WD.width,WD.height);var i=(EB.sqrt(w.length)+0.5).toInt();var CC=i~/2;var h=DB.data;var s=DB.width;var OB=DB.height;var UB=s;var JD=OB;var VB=GB.oB(WD.width,WD.height);var p=VB.data;var KD=divide==1?w:cD(w,i,divide);for(var j=1;j<JD-1;j++ ){for(var o=1;o<UB-1;o++ ){var g=(j*UB+o)*4;var eB=0.0,FB=0.0,WB=0.0,LD=0.0;for(var m=0;m<i;m++ ){for(var k=0;k<i;k++ ){var q=j+m-CC;var AB=o+k-CC;if(q>=0&&q<OB&&AB>=0&&AB<s){var l=(q*s+AB)*4;var n=KD[m*i+k];eB+= h[l+0]*n;FB+= h[l+1]*n;WB+= h[l+2]*n;LD+= h[l+3]*n;}}}p[g+0]=ZB(h[g+0],eB,mix).toInt();p[g+1]=ZB(h[g+1],FB,mix).toInt();p[g+2]=ZB(h[g+2],WB,mix).toInt();p[g+3]=h[g+3];}}ZD.putImageData(VB,0,0);} cD( k, h, m){var j=new List<double>(k.length);for(var g=0;g<h;g++ ){for(var i=0;i<h;i++ ){var l=g*h+i;j[l]=k[l]/m;}}return j;} blur({ mix: 1})=>IB([1,1,1,1,1,1,1,1,1],mix:mix,divide:9); FD({ mix: 1})=>IB([0,-1,0,-1,5,-1,0,-1,0],mix:mix);}class pB{final  position;final  button;pB(this.position,this.button);}class pC{final  yC;final  NB;pC(this.yC,this.NB);}typedef  qC( x, y);class rC{var r,TB,b,a;rC.UD( h,[this.a=255]){var g=qB(h);r=g[0];TB=g[1];b=g[2];} HD()=>[r,TB,b,a];} qB( g){return [int.parse('0x${g[1]}${g[2]}'),int.parse('0x${g[3]}${g[4]}'),int.parse('0x${g[5]}${g[6]}')];} sC( g, h, i){return '#${((1<<24)+(g<<16)+(h<<8)+i).toRadixString(16).substring(1,7)}';} rB( g)=>sB(g[0],g[1],g[2]); sB( l, g, i){var h=EB.max(EB.max(l,g),i),k=EB.min(EB.min(l,g),i);var j,n,o=(h+k)/(2*255);if(h==k){j=n=0.0;}else{var m=h-k;n=o>0.5?m/(2*255-h-k):m/(h+k);switch (h){case l:j=(g-i)/m+(g<i?6:0);break;case g:j=(i-l)/m+2;break;case i:j=(l-g)/m+4;break;}j/= 6.0;}return [j,n,o];} tB( s, q, w){var m=s.toDouble();var k=q.toDouble();var j=w.toDouble();var l;var n;var o;if(k==0.0){l=n=o=j;}else{var p=( h, i, g){if(g<0)g+= 1;if(g>1)g-= 1;if(g<1/6)return h+(i-h)*6*g;if(g<1/2)return i;if(g<2/3)return h+(i-h)*(2/3-g)*6;return h;};var i=j<0.5?j*(1+k):j+k-j*k;var h=2*j-i;l=p(h,i,m+1/3);n=p(h,i,m);o=p(h,i,m-1/3);}return [(l*255+0.5).toInt(),(n*255+0.5).toInt(),(o*255+0.5).toInt()];} HB( g)=>tC(g[0],g[1],g[2]); tC( k, g, i){var h=EB.max(EB.max(k,g),i),m=EB.min(EB.min(k,g),i);var j,n,o=h/255;var l=h-m;n=h==0.0?0.0:l/h;if(h==m){j=0.0;}else{switch (h){case k:j=(g-i)/l+(g<i?6:0);break;case g:j=(i-k)/l+2;break;case i:j=(k-g)/l+4;break;}j/= 6.0;}return [j,n,o];} SB( w, s, AB){var o=w.toDouble();var m=s.toDouble();var g=AB.toDouble();var h,i,j;var q=(o*6).toInt();var p=o*6-q;var k=g*(1-m);var n=g*(1-p*m);var l=g*(1-(1-p)*m);switch (q%6){case 0:h=g;i=l;j=k;break;case 1:h=n;i=g;j=k;break;case 2:h=k;i=g;j=l;break;case 3:h=k;i=n;j=g;break;case 4:h=l;i=k;j=g;break;case 5:h=g;i=k;j=n;break;}return [(h*255+0.5).toInt(),(i*255+0.5).toInt(),(j*255+0.5).toInt()];}//@ sourceMappingURL=out.dart.map
